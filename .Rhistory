}
transpose_df <- function(df) {
t_df <- data.table::transpose(df)
colnames(t_df) <- rownames(df)
rownames(t_df) <- colnames(df)
t_df <- t_df %>%
tibble::rownames_to_column(.data = .) %>%
tibble::as_tibble(.)
return(t_df)
}
header.true <- function(df) {
names(df) <- as.character(unlist(df[1,]))
df[-1,]
}
data <- data_raw %>% select(-all_of(remove_columns))
fviz_nbclust(data, kmeans, method = "wss") +
geom_vline(xintercept = K, linetype = 2)
km.res <- kmeans(data, K, iter.max = 10, nstart = 1)
x <- evaluate_cluster(km.res$cluster)
evaluate_cluster <- function(clusters) {
data <- cbind(data, cluster = clusters) %>%
mutate(cluster = factor(paste0('Cluster ', cluster)))
table(data_raw$group, data$cluster) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Group') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos grupos nos clusters', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Cluster'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
table(data$cluster, data_raw$group) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Cluster') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos clusters nos grupos', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Group'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
averages_df <- data %>%
group_by(cluster) %>%
summarise(across(everything(), list(mean = mean)))
transpose_df %>%
# header.true %>%
row_to_names(row_number = 2) %>%
niceFormatting %>%
print
}
library(janitor)
niceFormatting = function(df, caption="", digits = 2, font_size = NULL, label = 1){
df %>%
kbl(booktabs = T, longtable = T, caption = caption,
digits = digits, format = "latex", label = label) %>%
kable_styling(font_size = font_size,
latex_options = c("striped", "HOLD_position", "repeat_header"))
}
transpose_df <- function(df) {
t_df <- data.table::transpose(df)
colnames(t_df) <- rownames(df)
rownames(t_df) <- colnames(df)
t_df <- t_df %>%
tibble::rownames_to_column(.data = .) %>%
tibble::as_tibble(.)
return(t_df)
}
header.true <- function(df) {
names(df) <- as.character(unlist(df[1,]))
df[-1,]
}
data <- data_raw %>% select(-all_of(remove_columns))
fviz_nbclust(data, kmeans, method = "wss") +
geom_vline(xintercept = K, linetype = 2)
km.res <- kmeans(data, K, iter.max = 10, nstart = 1)
x <- evaluate_cluster(km.res$cluster)
evaluate_cluster <- function(clusters) {
data <- cbind(data, cluster = clusters) %>%
mutate(cluster = factor(paste0('Cluster ', cluster)))
table(data_raw$group, data$cluster) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Group') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos grupos nos clusters', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Cluster'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
table(data$cluster, data_raw$group) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Cluster') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos clusters nos grupos', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Group'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
averages_df <- data %>%
group_by(cluster) %>%
summarise(across(everything(), list(mean = mean)))
transpose_df %>%
# header.true %>%
# row_to_names(row_number = 2) %>%
niceFormatting %>%
print
}
library(janitor)
niceFormatting = function(df, caption="", digits = 2, font_size = NULL, label = 1){
df %>%
kbl(booktabs = T, longtable = T, caption = caption,
digits = digits, format = "latex", label = label) %>%
kable_styling(font_size = font_size,
latex_options = c("striped", "HOLD_position", "repeat_header"))
}
transpose_df <- function(df) {
t_df <- data.table::transpose(df)
colnames(t_df) <- rownames(df)
rownames(t_df) <- colnames(df)
t_df <- t_df %>%
tibble::rownames_to_column(.data = .) %>%
tibble::as_tibble(.)
return(t_df)
}
header.true <- function(df) {
names(df) <- as.character(unlist(df[1,]))
df[-1,]
}
data <- data_raw %>% select(-all_of(remove_columns))
fviz_nbclust(data, kmeans, method = "wss") +
geom_vline(xintercept = K, linetype = 2)
km.res <- kmeans(data, K, iter.max = 10, nstart = 1)
x <- evaluate_cluster(km.res$cluster)
evaluate_cluster <- function(clusters) {
data <- cbind(data, cluster = clusters) %>%
mutate(cluster = factor(paste0('Cluster ', cluster)))
table(data_raw$group, data$cluster) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Group') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos grupos nos clusters', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Cluster'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
table(data$cluster, data_raw$group) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Cluster') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos clusters nos grupos', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Group'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
averages_df <- data %>%
group_by(cluster) %>%
summarise(across(everything(), list(mean = mean)))
# transpose_df %>%
# niceFormatting %>%
# print
}
niceFormatting = function(df, caption="", digits = 2, font_size = NULL, label = 1){
df %>%
kbl(booktabs = T, longtable = T, caption = caption,
digits = digits, format = "latex", label = label) %>%
kable_styling(font_size = font_size,
latex_options = c("striped", "HOLD_position", "repeat_header"))
}
transpose_df <- function(df) {
t_df <- data.table::transpose(df)
colnames(t_df) <- rownames(df)
rownames(t_df) <- colnames(df)
t_df <- t_df %>%
tibble::rownames_to_column(.data = .) %>%
tibble::as_tibble(.)
return(t_df)
}
data <- data_raw %>% select(-all_of(remove_columns))
fviz_nbclust(data, kmeans, method = "wss") +
geom_vline(xintercept = K, linetype = 2)
km.res <- kmeans(data, K, iter.max = 10, nstart = 1)
x <- evaluate_cluster(km.res$cluster)
x
# fviz_cluster(km.res, data = data,
#              palette = c("#2E9FDF", "#00AFBB", "#E7B800"),
#              geom = "point",
#              ellipse.type = "convex",
#              ggtheme = theme_bw()
#              )
evaluate_cluster <- function(clusters) {
data <- cbind(data, cluster = clusters) %>%
mutate(cluster = factor(paste0('Cluster ', cluster)))
table(data_raw$group, data$cluster) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Group') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos grupos nos clusters', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Cluster'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
table(data$cluster, data_raw$group) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Cluster') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos clusters nos grupos', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Group'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
averages_df <- data %>%
group_by(cluster) %>%
summarise(across(everything(), list(mean = mean))) %>%
transpose_df %>%
header.true %>%
niceFormatting %>%
print
}
niceFormatting = function(df, caption="", digits = 2, font_size = NULL, label = 1){
df %>%
kbl(booktabs = T, longtable = T, caption = caption,
digits = digits, format = "latex", label = label) %>%
kable_styling(font_size = font_size,
latex_options = c("striped", "HOLD_position", "repeat_header"))
}
transpose_df <- function(df) {
t_df <- data.table::transpose(df)
colnames(t_df) <- rownames(df)
rownames(t_df) <- colnames(df)
t_df <- t_df %>%
tibble::rownames_to_column(.data = .) %>%
tibble::as_tibble(.)
return(t_df)
}
header.true <- function(df) {
names(df) <- as.character(unlist(df[1,]))
df[-1,]
}
data <- data_raw %>% select(-all_of(remove_columns))
fviz_nbclust(data, kmeans, method = "wss") +
geom_vline(xintercept = K, linetype = 2)
km.res <- kmeans(data, K, iter.max = 10, nstart = 1)
x <- evaluate_cluster(km.res$cluster)
x
# fviz_cluster(km.res, data = data,
#              palette = c("#2E9FDF", "#00AFBB", "#E7B800"),
#              geom = "point",
#              ellipse.type = "convex",
#              ggtheme = theme_bw()
#              )
evaluate_cluster <- function(clusters) {
data <- cbind(data, cluster = clusters) %>%
mutate(cluster = factor(paste0('Cluster ', cluster)))
table(data_raw$group, data$cluster) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Group') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos grupos nos clusters', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Cluster'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
table(data$cluster, data_raw$group) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Cluster') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos clusters nos grupos', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Group'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
averages_df <- data %>%
group_by(cluster) %>%
summarise(across(everything(), list('' = mean))) %>%
transpose_df %>%
header.true %>%
niceFormatting %>%
print
}
evaluate_cluster <- function(clusters) {
data <- cbind(data, cluster = clusters) %>%
mutate(cluster = factor(paste0('Cluster ', cluster)))
table(data_raw$group, data$cluster) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Group') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos grupos nos clusters', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Cluster'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
table(data$cluster, data_raw$group) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Cluster') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos clusters nos grupos', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Group'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
averages_df <- data %>%
group_by(cluster) %>%
summarise(across(everything(), list(mean = mean))) %>%
transpose_df %>%
header.true %>%
niceFormatting %>%
print
}
niceFormatting = function(df, caption="", digits = 2, font_size = NULL, label = 1){
df %>%
kbl(booktabs = T, longtable = T, caption = caption,
digits = digits, format = "latex", label = label) %>%
kable_styling(font_size = font_size,
latex_options = c("striped", "HOLD_position", "repeat_header"))
}
transpose_df <- function(df) {
t_df <- data.table::transpose(df)
colnames(t_df) <- rownames(df)
rownames(t_df) <- colnames(df)
t_df <- t_df %>%
tibble::rownames_to_column(.data = .) %>%
tibble::as_tibble(.)
return(t_df)
}
header.true <- function(df) {
names(df) <- as.character(unlist(df[1,]))
df[-1,]
}
evaluate_cluster <- function(clusters) {
data <- cbind(data, cluster = clusters) %>%
mutate(cluster = factor(paste0('Cluster ', cluster)))
table(data_raw$group, data$cluster) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Group') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos grupos nos clusters', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Cluster'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
table(data$cluster, data_raw$group) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Cluster') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos clusters nos grupos', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Group'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
averages_df <- data %>%
group_by(cluster) %>%
summarise(across(everything(), list(mean = mean))) %>%
transpose_df %>%
header.true %>%
niceFormatting(digits = 2) %>%
print
}
niceFormatting = function(df, caption="", digits = 2, font_size = NULL, label = 1){
df %>%
kbl(booktabs = T, longtable = T, caption = caption,
digits = digits, format = "latex", label = label) %>%
kable_styling(font_size = font_size,
latex_options = c("striped", "HOLD_position", "repeat_header"))
}
transpose_df <- function(df) {
t_df <- data.table::transpose(df)
colnames(t_df) <- rownames(df)
rownames(t_df) <- colnames(df)
t_df <- t_df %>%
tibble::rownames_to_column(.data = .) %>%
tibble::as_tibble(.)
return(t_df)
}
header.true <- function(df) {
names(df) <- as.character(unlist(df[1,]))
df[-1,]
}
data <- data_raw %>% select(-all_of(remove_columns))
fviz_nbclust(data, kmeans, method = "wss") +
geom_vline(xintercept = K, linetype = 2)
km.res <- kmeans(data, K, iter.max = 10, nstart = 1)
x <- evaluate_cluster(km.res$cluster)
x
# fviz_cluster(km.res, data = data,
#              palette = c("#2E9FDF", "#00AFBB", "#E7B800"),
#              geom = "point",
#              ellipse.type = "convex",
#              ggtheme = theme_bw()
#              )
evaluate_cluster <- function(clusters) {
data <- cbind(data, cluster = clusters) %>%
mutate(cluster = factor(paste0('Cluster ', cluster)))
table(data_raw$group, data$cluster) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Group') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos grupos nos clusters', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Cluster'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
table(data$cluster, data_raw$group) %>%
addpercentage %>%
as.data.frame %>%
rownames_to_column(var = 'Cluster') %>%
kbl(align = "c", booktabs = T, digits = 2, format = 'latex',
caption = 'Distribuição dos clusters nos grupos', label = 1) %>%
row_spec(K, hline_after = T) %>%
column_spec(K + 1, border_right = T) %>%
collapse_rows(1, latex_hline = "none") %>%
add_header_above(c(' ' = 1,
setNames(K, 'Group'))) %>%
kable_styling(latex_options = c("HOLD_position", "repeat_header")) %>%
print
averages_df <- data %>%
group_by(cluster) %>%
summarise(across(everything(), list(mean = mean))) %>%
transpose_df %>%
mutate(across(where(is.numeric), round, 3)) %>%
header.true %>%
niceFormatting %>%
print
}
niceFormatting = function(df, caption="", digits = 2, font_size = NULL, label = 1){
df %>%
kbl(booktabs = T, longtable = T, caption = caption,
digits = digits, format = "latex", label = label) %>%
kable_styling(font_size = font_size,
latex_options = c("striped", "HOLD_position", "repeat_header"))
}
transpose_df <- function(df) {
t_df <- data.table::transpose(df)
colnames(t_df) <- rownames(df)
rownames(t_df) <- colnames(df)
t_df <- t_df %>%
tibble::rownames_to_column(.data = .) %>%
tibble::as_tibble(.)
return(t_df)
}
header.true <- function(df) {
names(df) <- as.character(unlist(df[1,]))
df[-1,]
}
data <- data_raw %>% select(-all_of(remove_columns))
fviz_nbclust(data, kmeans, method = "wss") +
geom_vline(xintercept = K, linetype = 2)
km.res <- kmeans(data, K, iter.max = 10, nstart = 1)
evaluate_cluster(km.res$cluster)
# fviz_cluster(km.res, data = data,
#              palette = c("#2E9FDF", "#00AFBB", "#E7B800"),
#              geom = "point",
#              ellipse.type = "convex",
#              ggtheme = theme_bw()
#              )
